#summary Several examples of comparison of ADDA with other codes

Many researchers have used *ADDA* and compared it with other codes based on the DDA or other light scattering methods. The purpose of this page is to give a few representative examples instead of providing a full overview. Figures on this page can be clicked to open a larger image.

<wiki:toc />

= Comparison with other DDA codes =

Comparison of four different DDA codes, including *ADDA* 0.7a and [http://www.astro.princeton.edu/~draine/DDSCAT.6.1.html DDSCAT 6.1], was performed by Penttila et al. [[#References 1]] for simulation of different wavelength-sized particles both in single orientation and averaged over all orientations. Here we present a brief summary and a few sample results from this paper. *ADDA* is faster than other codes by a factor of 2.3 to 16 and it is the least memory consuming code. Results of simulations of light scattering by a sphere in a fixed orientation are shown in the following figure. All scatterers considered in this section have volume-equivalent size parameter 5.1 and refractive index 1.313. SIRRI and ZDD denote codes by Simulintu Oy in Finland and Zubko and Shkuratov respectively. All codes result in almost identical relative error of _S_,,11,,(_θ_), as compared with the Mie theory, showing that the codes use the same formulation of DDA, except SIRRI's that is slightly different.

[http://a-dda.googlecode.com/svn/wiki/sphere_dda_large.png http://a-dda.googlecode.com/svn/wiki/sphere_dda_small.png]

On contrary, orientation averaging schemes of the codes are different. Orientation averaged results for a randomly constructed aggregate of 50 spheres are shown in the next figure (here and below reference results are obtained using the T-matrix method). One can see that results differ, and the errors of *ADDA* results are the largest. That is explained by the fact that for *ADDA* we used 16×9×8 sample points for Euler angles _α_, _β_, and _γ_ respectively. Other codes used less _α_ sample angles (11, 4, and 1) but more _β_ and _γ_ sample angles, resulting in approximately the same total number of sample angles. Therefore, *ADDA* is faster at expense of possible deterioration of accuracy. However, for other asymmetric particles studied in [[#References 1]] *ADDA* results in comparable to other codes accuracy even with current settings (particle showed here was the least favorable for *ADDA*).

[http://a-dda.googlecode.com/svn/wiki/aggregate_dda_large.png http://a-dda.googlecode.com/svn/wiki/aggregate_dda_small.png]

The results for axisymmetric particles are principally different. Here we consider only a prolate spheroid with aspect ratio 2 (see the next figure). One can see that *ADDA* result (the first curve) is much less accurate than other codes. The accuracy of *ADDA* is unusually bad, even compared to the previous figure. In the following we explain this fact. For axisymmetric particles the dipole array is symmetric with respect to 90° rotation over the symmetry axis. Moreover, the range from 0° to 90° for _γ_ is mirror symmetric with respect to the 45°. Hence, the most efficient way of orientation averaging for such particles is to sample _γ_ uniformly in the range from 0° to 45°, and also to use less _γ_ sample angles but more _β_ sample angles. Sampling by other codes satisfies these conditions. The situation for *ADDA* is remarkably different. 8 _γ_ angles are used, which are spaced with interval 45°, hence they map in only two distinct angles (0° and 45°) inside the reduced range. That means that for axisymmetric particles *ADDA* repeats calculation for four equivalent sets of orientations. Moreover, Romberg integration, which is a higher order method, performs unsatisfactory when applied to a range that contains several periods of the periodic function to be integrated and only a few points per each period. An analogous discussion applies to the _β_ angle since both spheroid and cylinder have a symmetry plane perpendicular to the symmetry axis.

[http://a-dda.googlecode.com/svn/wiki/spheroid_dda_large.png http://a-dda.googlecode.com/svn/wiki/spheroid_dda_small.png]

It is important to note that *ADDA* is perfectly suitable to calculate orientation averaging of axisymmetric particles efficiently, but it requires a user to manually modify the sampling intervals for Euler angles in the input files. For instance, for the discussed scatterers the choice of 17 _β_ angles from 0° to 90° and 5 _γ_ angles from 0° to 45° is appropriate. The result of this tuned orientation averaging for spheroid, obtained using *ADDA* 0.76, is shown as the last curve in the previous figure. It requires about 20% more computational time than the initial scheme, but still it is significantly faster than other codes. One can see that its accuracy is comparable to or even better than that of other codes. This result was not included in [[#References 1]], because such modifications of the input files were considered a ‘fine-tuning’. DDSCAT may also benefit from reduction of angle ranges, but in much lesser extent (in these particular cases).

Therefore, we may conclude that *ADDA* is clearly superior for particles in single orientation. Its orientation averaging scheme is not that flexible, especially when small number of sample angles is used. However, in most cases it results in accuracy not worse than that of other codes, if particle symmetries are properly accounted for. Moreover, inflexibility is compensated by the adaptability of the *ADDA* orientation averaging scheme and its ability to estimate the averaging error. We should also note, that the optimum strategy for orientation averaging is still an open question (see e.g. issue 40).

Finally, the described comparison is already outdated. Both *ADDA* and DDSCAT have undergone significant improvement since that time. Moreover, a new code [http://www.opendda.org/ OpenDDA] have been released, claiming superior computational efficiency.

= Comparison with the multiple multipole program =

To validate the part of *ADDA*, which simulates scattering by a Gaussian beam, we conducted a simple test and compared results with that of the [http://www.scattport.org/index.php/programs-menu/generalized-multipole-menu/49-3d-mmp multiple multipole program]. The latter were provided by Roman Schuh and Thomas Wriedt. Sphere with size parameter 5 and refractive index 1.5 is illuminated with a Gaussian beam with wavelength 1 µm, width 2 µm, and position of the beam center (1,1,1) µm. The beam propagates along the _z_-axis. We calculated _S_,,11,,(_θ_) in the _yz_-plane, scattering angle _θ_ was considered from the _z_-axis to the _y_-axis. We used 64 dipoles per diameter of the sphere. *ADDA* 0.76 was used with a command line:
{{{
adda -grid 64 -lambda 1 -size 1.59155 -beam barton5 2 1 1 1 -ntheta 180
}}}
The results are shown in the following figure, indicating perfect agreement between two methods.

[http://a-dda.googlecode.com/svn/wiki/mmp_dda_large.png http://a-dda.googlecode.com/svn/wiki/mmp_dda_small.png]

= Comparison with the FDTD =

A systematic comparison of the DDA and the finite difference time domain (FDTD) method was performed for large dielectric scatterers by Yurkin et al. [[#References 2]]. Here we summarize these results. Simulations were performed for spheres with size parameter _x_ from 20 to 80 and refractive index _m_ from 1.02 to 2 (all _m_ also had a fixed negligible imaginary part). Since both methods are potentially exact if infinite discretization is employed, a certain accuracy was required – relative error of _Q_,,ext,, less than 1% and the root-mean-square relative error of _S_,,11,, over the whole range of _θ_ less than 25%. Then simulation times were compared. *ADDA* v.0.76 was used as DDA implementation, and FDTD implementation was developed in the Biomedical Laser Laboratory at East Carolina University, based on the algorithms described by Yang and Liou with numerical dispersion correction (see [[#References 2]] for details).

The main conclusion is summarized in the following figure, where a ratio of computational times of two methods is shown versus _x_ for different _m_. The DDA is more than an order of magnitude faster for _m_ ≤1.2 and _x_>30, while for _m_ ≥1.7 the FDTD is faster by the same extent. _m_=1.4 is a boundary value, for which both methods perform comparably. The DDA errors of _S_,,11,,(_θ_) for _m_=1.02 are mostly due to the shape errors, which are expected to be smaller for rough and/or inhomogeneous particles. Simulations for a few sample biological cells lead to the same conclusions. Although these conclusions depend on particular scattering quantity and on the implementations of both methods, they will not change principally unless a major improvement of one of the method is made. However, for general complex refractive indices the results of the comparison are expected to be significantly different.

[http://a-dda.googlecode.com/svn/wiki/fdtd_dda_large.png http://a-dda.googlecode.com/svn/wiki/fdtd_dda_small.png]

= Comparison with the null-field method with discrete sources =

Schmidt and Wriedt [[#References 3]] extended the null-field method with discrete sources ([http://www.scattport.org/index.php/programs-menu/t-matrix-codes-menu/239-nfm-ds NFM_DS]) to anisotropic scatterers and verified their code by comparison with *ADDA* and DDSCAT. The following figure shows one particular example for ellipsoid with semi-axes _ka_=2, _kb_=3, _kc_=4 (_k_ is the wavenumber) and refractive index _m,,x,,_=1.5, _m,,y,,_=_m,,z,,_=1.1. Incident wave propagates along the _z_-axis and _S_,,11,, is calculated in _xz_-plane. NFM-DS data was provided by Vladimir Schmidt. *ADDA* 0.79 was run with the following command line.
{{{
adda -size 4 -shape ellipsoid 1.5 2 -m 1.5 0 1.1 0 1.1 0 -anisotr -orient 90 0 0
}}}
where the last option (`-orient`) was used for convenience to make the first two columns of the file `mueller`  produced by *ADDA* (corresponding to _yz_-plane in particle reference frame) equivalent to the sought _S_,,11,, in _xz_-plane in laboratory reference frame.

[http://a-dda.googlecode.com/svn/wiki/nfmds_dda_large.png http://a-dda.googlecode.com/svn/wiki/nfmds_dda_small.png]

= Comparison with the improved geometric optics method =

Bi et al. compared *ADDA* with the improved geometric optics method (IGOM) for simulation of randomly-oriented ellipsoids [[#References 4]] and hexahedra [[#References 5]]. The accuracy of the *ADDA* was assumed good enough (unfortunately, the details of the DDA simulations were not specified), while accuracy of IGOM is tested against it. A particular example from [[#References 5]] is shown in the following figure, depicting integrated scattering properties of randomly oriented nonsymmetric hexahedra versus the size parameter. One can see that both methods agree in intermediate size parameter range, thus effectively closing the gap between geometric-optics and wave-optics methods. However, the deviations for angle-resolved light scattering properties ,e.g. _S_,,11,,, can still be significant (see [[#References 5]] for details).

[http://a-dda.googlecode.com/svn/wiki/igom_dda_large.png http://a-dda.googlecode.com/svn/wiki/igom_dda_small.png] 

= References =
 # A. Penttila, E. Zubko, K. Lumme, K. Muinonen, M.A. Yurkin, B.T. Draine, J. Rahola, A.G. Hoekstra, and Y. Shkuratov, “Comparison between discrete dipole implementations and exact techniques,” [http://dx.doi.org/10.1016/j.jqsrt.2007.01.026 J. Quant. Spectrosc. Radiat. Transfer 106, 417-436 (2007)].
 # M.A. Yurkin, A.G. Hoekstra, R.S. Brock, and J.Q. Lu, “Systematic comparison of the discrete dipole approximation and the finite difference time domain method for large dielectric scatterers,” [http://dx.doi.org/10.1364/OE.15.017902 Opt. Express 15, 17902-17911 (2007)].
 # V. Schmidt and T. Wriedt, “T-matrix method for biaxial anisotropic particles,” [http://dx.doi.org/10.1016/j.jqsrt.2009.01.025 J. Quant. Spectrosc. Radiat. Transfer 110, 1392-1397 (2009)].
 # L. Bi, P. Yang, G.W. Kattawar, and R. Kahn, “Single-scattering properties of triaxial ellipsoidal particles for a size parameter range from the Rayleigh to geometric-optics regimes,” [http://dx.doi.org/10.1364/AO.48.000114 Appl. Opt. 48, 114-126 (2009)].
 # L. Bi, P. Yang, G.W. Kattawar, and R. Kahn, “Modeling optical properties of mineral aerosol particles by using nonsymmetric hexahedra,” [http://dx.doi.org/10.1364/AO.49.000334 Appl. Opt. 49, 334-342 (2010)].